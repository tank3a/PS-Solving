//문제 링크 : https://www.acmicpc.net/problem/2602
```
import java.util.*;
import java.io.*;

public class Main
{
    static String magic;
    static char[] angel; // dir=true
    static char[] devil; // dir=false
    
    // 두루마리 뒤부터 색인
    static int recursive(int mindex, int sindex, boolean dir) {
        if (mindex < 0 || sindex < 0) return 0;
        
        char t = magic.charAt(mindex);
        
        // 두루마리 첫번째 문자에 도달
        if (mindex == 0) {
            if (dir) {
                if (angel[sindex] == t) {
                    return recursive(mindex, sindex - 1, dir) + 1;
                } else {
                    return recursive(mindex, sindex - 1, dir);
                }
            } else {
                if (devil[sindex] == t) {
                    return recursive(mindex, sindex - 1, dir) + 1;
                } else {
                    return recursive(mindex, sindex - 1, dir);
                }
            }
        }
        
        int sum = 0;
        
        if (dir) {
            if (angel[sindex] == t) {
                sum += recursive(mindex, sindex - 1, dir); // 일치했으나 무시하고 다음 돌 찾음
                sum += recursive(mindex - 1, sindex - 1, !dir); // 일치 확인 대상 문자 변경
            } else {
                return recursive(mindex, sindex - 1, dir);
            }
        } else {
            if (devil[sindex] == t) {
                sum += recursive(mindex, sindex - 1, dir); // 일치했으나 무시하고 다음 돌 찾음
                sum += recursive(mindex - 1, sindex - 1, !dir); // 일치 확인 대상 문자 변경
            } else {
                return recursive(mindex, sindex - 1, dir);
            }
        }
        
        return sum;
    }
    
	public static void main(String[] args) throws IOException {
	    BufferedReader bf = new BufferedReader(new InputStreamReader(System.in));
	    
	    magic = bf.readLine();
	    String input = bf.readLine();
	    
	    angel = new char[input.length()];
	    devil = new char[input.length()];
	    
	    for (int i = 0; i < input.length(); i++) {
	        devil[i] = input.charAt(i);
	    }
	    
	    input = bf.readLine();
	    for (int i = 0; i < input.length(); i++) {
	        angel[i] = input.charAt(i);
	    }
	    
	    System.out.print(recursive(magic.length() - 1, angel.length - 1, true) + recursive(magic.length() - 1, angel.length - 1, false));
	}
}
```
